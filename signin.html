<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Cynvia One- Sign In</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background-color: #f0f0f0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            min-height: 100vh;
            padding: 60px 40px;
        }

        .container {
            max-width: 400px;
            margin: 0 auto;
        }

        .logo {
            font-size: 22px;
            font-weight: 700;
            color: #000;
            margin-bottom: 16px;
            text-align: center;
            letter-spacing: -1px;
        }

        .subtitle {
            font-size: 18px;
            color: #666;
            margin-bottom: 80px;
            font-weight: 400;
            text-align: center;
        }

        .signin-title {
            font-size: 52px;
            font-weight: 700;
            margin-bottom: 60px;
            color: #000;
            text-align: left;
        }

        .signin-title .in {
            color: #4a6fa5;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .input-field {
            width: 100%;
            padding: 24px 28px;
            border: none;
            border-radius: 50px;
            background-color: #d8d8d8;
            font-size: 18px;
            color: #999;
            outline: none;
            transition: all 0.3s ease;
        }

        .input-field:focus {
            background-color: #ccc;
            color: #333;
        }

        .input-field::placeholder {
            color: #999;
            font-weight: 400;
        }

        .forgot-password {
            text-align: left;
            margin: 40px 0 50px 0;
        }

        .forgot-password a {
            color: #000;
            text-decoration: none;
            font-size: 18px;
            font-weight: 500;
        }

        .forgot-password a:hover {
            text-decoration: underline;
        }

        .signin-btn {
            width: 100%;
            padding: 22px;
            border: none;
            border-radius: 50px;
            background-color: #4a6fa5;
            color: white;
            font-size: 20px;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.3s ease;
            margin-bottom: 40px;
        }

        .signin-btn:hover {
            background-color: #3d5a8a;
        }

        .create-account {
            text-align: center;
        }

        .create-account a {
            color: #4a6fa5;
            text-decoration: none;
            font-size: 18px;
            font-weight: 500;
        }

        .create-account a:hover {
            text-decoration: underline;
        }

        @media (max-width: 480px) {
            body {
                padding: 40px 30px;
            }
            
            .logo {
                font-size: 40px;
            }
            
            .signin-title {
                font-size: 44px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="logo">Cynvia One</h1>
        <p class="subtitle">Welcome to our community</p>
        
        <h2 class="signin-title">Sign <span class="in">in</span></h2>
        
        <form id="signinForm">
            <div class="form-group">
                <!-- added id attributes so script can target them (UI unchanged) -->
                <input id="emailInput" type="email" class="input-field" placeholder="Email" required>
            </div>
            
            <div class="form-group">
                <input id="passwordInput" type="password" class="input-field" placeholder="Password" required>
            </div>
            
            <div class="forgot-password">
                <a href="#" id="forgotPasswordLink">Forgot password?</a>
            </div>
            
            <button type="submit" class="signin-btn">Sign in</button>
        </form>
        
        <div class="create-account">
            <a href="signup.html" id="createAccountLink">Create a account</a>
        </div>
    </div>

    <!-- Firebase + auth logic (CDN, modular) -->
    <script type="module">
      // Import Firebase (modular CDN)
      import { initializeApp } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-app.js";
      import { 
        getAuth,
        signInWithEmailAndPassword,
        sendPasswordResetEmail,
        onAuthStateChanged
      } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-auth.js";

      // <-- your firebaseConfig (same as index) -->
      const firebaseConfig = {
        apiKey: "AIzaSyDaRo6aKcg5Tju7spWUtLKOUBEItUpgF90",
        authDomain: "ouruiofficial.firebaseapp.com",
        projectId: "ouruiofficial",
        storageBucket: "ouruiofficial.firebasestorage.app",
        messagingSenderId: "513335403025",
        appId: "1:513335403025:web:b965e1187d5386d52d87b0",
        measurementId: "G-X5QWNP8DMK"
      };

      // Initialize Firebase
      const app = initializeApp(firebaseConfig);
      const auth = getAuth(app);

      // Elements
      const signinForm = document.getElementById('signinForm');
      const emailInput = document.getElementById('emailInput');
      const passwordInput = document.getElementById('passwordInput');
      const forgotPasswordLink = document.getElementById('forgotPasswordLink');
      const createAccountLink = document.getElementById('createAccountLink');

      // If already signed in, redirect to index (optional)
      onAuthStateChanged(auth, (user) => {
        if (user) {
          // User is already signed in — go to home
          // (comment this line if you don't want auto-redirect)
          window.location.href = 'index.html';
        }
      });

      // Helper: send reset email and notify
      async function sendReset(email) {
        try {
          await sendPasswordResetEmail(auth, email);
          alert('✅ Password reset email sent. Check your inbox.');
        } catch (err) {
          let msg = err.message || String(err);
          if (err.code === 'auth/user-not-found') msg = 'No account found with this email.';
          if (err.code === 'auth/invalid-email') msg = 'Invalid email address.';
          alert('❌ ' + msg);
        }
      }

      // Sign in handler
      signinForm.addEventListener('submit', async (e) => {
        e.preventDefault();
        const email = (emailInput.value || '').trim();
        const password = passwordInput.value || '';

        if (!email) {
          alert('Please enter your email.');
          return;
        }

        // If password empty, ask to send reset email
        if (!password) {
          const send = confirm('Password is empty. Did you forget your password?\n\nClick OK to send a password reset email, or Cancel to enter password.');
          if (send) {
            await sendReset(email);
          }
          return;
        }

        try {
          const cred = await signInWithEmailAndPassword(auth, email, password);
          // success
          alert('✅ Logged in: ' + (cred.user.email || ''));
          window.location.href = 'index.html';
        } catch (err) {
          // Friendly messages and actions
          let code = err.code || '';
          let msg = err.message || String(err);

          if (code === 'auth/user-not-found') {
            const create = confirm('No account found with this email. Create an OurUI account now?');
            if (create) {
              // Redirect to signup and prefill email via query param
              window.location.href = `signup.html?email=${encodeURIComponent(email)}`;
            }
            return;
          }

          if (code === 'auth/wrong-password') {
            const reset = confirm('Wrong password. Forgot password?\n\nClick OK to send a password reset email.');
            if (reset) {
              await sendReset(email);
            }
            return;
          }

          if (code === 'auth/invalid-email') {
            msg = 'Invalid email address.';
          }

          alert('❌ ' + msg);
        }
      });

      // Forgot password link handler (asks for email if empty)
      forgotPasswordLink.addEventListener('click', async (e) => {
        e.preventDefault();
        let email = (emailInput.value || '').trim();

        if (!email) {
          email = window.prompt('Enter your email to receive password reset link:');
          if (!email) return; // user cancelled or didn't provide
        }

        await sendReset(email.trim());
      });

      // If user clicks Create Account link but we have an email, pass it to signup page
      createAccountLink.addEventListener('click', (e) => {
        const email = (emailInput.value || '').trim();
        if (email) {
          e.preventDefault();
          window.location.href = `signup.html?email=${encodeURIComponent(email)}`;
        }
      });
    </script>
</body>
</html>
