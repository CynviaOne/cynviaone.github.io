<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>CynviaOne — Your device</title>

<!-- Fonts / icons -->
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500,700&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@20..48,600,1,0" rel="stylesheet">

<style>
:root{
  --bg:#fbf9fb;
  --card:#e6e4e7;
  --muted:#a7a5a6;
  --title:#0b0b0b;
  --accent:#3f5f90;
  --radius:18px;
  --max-w:380px;
  --icon-size-lg:32px;
  --icon-size-md:24px;
  --icon-slot:56px;
  --gap-22:18px;
}
*{box-sizing:border-box}
html,body{height:100%;margin:0;background:var(--bg);font-family:"Roboto",system-ui,Arial;color:var(--title);-webkit-font-smoothing:antialiased}
.wrap{max-width:var(--max-w);margin:8px auto;padding:18px 16px 40px}
.material-rounded{font-family: 'Material Symbols Rounded';font-variation-settings: "FILL" 1, "wght" 600, "GRAD" 0, "opsz" 40;display:inline-block;line-height:1;vertical-align:middle}

/* Topbar */
.topbar{display:flex;align-items:center;justify-content:flex-start;margin-bottom:6px;gap:8px}
.btn-close{background:transparent;border:0;padding:6px;margin:0;font-size:18px;cursor:pointer;color:var(--title);display:inline-flex;align-items:center;justify-content:center;border-radius:8px}
.logo{font-weight:700;font-size:20px}.logo .one{color:var(--accent);font-weight:600}

/* Header (match personalinfo sizes) */
.page-header{padding:16px 2px 20px}
.page-header h1{margin:0 0 8px;font-size:32px;font-weight:700;line-height:1.1}
.page-header .subtitle{margin:0 0 12px;font-size:16px;font-weight:600;color:var(--title)}
.page-header .description{margin:0;font-size:14px;line-height:1.4;color:var(--title);opacity:0.8;font-weight:400}

/* device card matches personalinfo card corner radius */
.device-card{
  background:var(--card);
  border-radius:var(--radius);
  overflow:hidden;
  padding:6px;
  margin-top:18px;
}

/* rows */
.device-row{
  display:flex;
  align-items:center;
  gap:14px;
  padding:18px 18px;
  min-height:72px;
}
.device-row + .device-row{border-top:1px solid rgba(0,0,0,0.06)}
.icon-slot{width:var(--icon-slot);height:var(--icon-slot);display:flex;align-items:center;justify-content:center;flex-shrink:0}
.icon-slot .material-rounded{font-size:var(--icon-size-lg);color:#000}
.row-content{flex:1}
.row-content h3{margin:0 0 6px;font-size:16px;font-weight:800}
.row-content p{margin:0;font-size:14px;color:var(--muted);font-weight:600}

/* status dot uses black always (as requested) */
.status-dot{width:16px;height:16px;border-radius:50%;background:#000;display:inline-block;box-shadow:none}

/* "Looking for something else?" and options */
.more{font-weight:700;font-size:20px;margin-top:26px;padding-left:2px}
.profile-section{background:var(--card);border-radius:var(--radius);padding:10px;margin-top:12px}
.profile-item{display:flex;align-items:center;gap:12px;padding:14px;border-radius:12px;cursor:pointer}
.profile-item + .profile-item{margin-top:8px}
.profile-item .icon{width:56px;display:flex;align-items:center;justify-content:center;flex-shrink:0;background:transparent;border-radius:12px}
.icon-lg{font-size:var(--icon-size-lg)}
.profile-item .content h3{margin:0;font-size:15px;font-weight:700}
.profile-item .content p{margin:4px 0 0;font-size:13px;color:var(--muted);font-weight:600}

/* notice area for diagnostics */
.notice{margin-top:12px;padding:10px;background:#fff;border-radius:12px;color:#333;border:1px solid rgba(0,0,0,0.04);font-size:13px;display:none}

/* small view adjustments */
@media (max-width:420px){
  :root{--max-w:100%}
  .wrap{padding-left:12px;padding-right:12px}
  .page-header h1{font-size:30px}
}
</style>
</head>
<body>
  <div class="wrap">
    <div class="topbar">
      <button class="btn-close" aria-label="Go back" onclick="goBack()">
        <span class="material-rounded" style="font-size:22px">arrow_back</span>
      </button>
      <div style="display:flex;flex-direction:column;line-height:1">
        <div class="logo">Cynvia<span class="one">One</span></div>
      </div>
    </div>

    <div class="page-header">
      <h1>Your device</h1>
      <p class="subtitle">Information about you device</p>
      <p class="description">View details about the device you're signed in on, including Android version, battery status, and other system information.</p>
    </div>

    <div class="device-card" role="list" aria-label="Device information">
      <div class="device-row" role="listitem" id="androidVersionRow">
        <div class="icon-slot"><span class="material-rounded">android</span></div>
        <div class="row-content">
          <h3>Android version</h3>
          <p id="androidVersionText">(User android version show here)</p>
        </div>
      </div>

      <div class="device-row" role="listitem" id="screenResRow">
        <div class="icon-slot"><span class="material-rounded">straighten</span></div>
        <div class="row-content">
          <h3>Screen resolutions</h3>
          <p id="screenResText">(user mobile screen resolutions show here)</p>
        </div>
      </div>

      <div class="device-row" role="listitem" id="statusRow">
        <div class="icon-slot"><span class="status-dot" id="statusDot" title="status indicator"></span></div>
        <div class="row-content">
          <h3>Status</h3>
          <p id="statusText">(user online or offline show here)</p>
        </div>
      </div>
    </div>

    <div class="more">Looking for something else?</div>

    <div class="profile-section" role="list" aria-label="More options">
      <div class="profile-item" id="aboutItem" tabindex="0" role="button" onclick="alert('About CynviaOne - Coming soon!')">
        <div class="icon"><span class="material-rounded icon-lg">info</span></div>
        <div class="content"><h3>About CynviaOne</h3><p>Learn more about CynviaOne</p></div>
      </div>

      <div class="profile-item" id="feedbackItem" tabindex="0" role="button" onclick="window.location.href='mailto:support.cynviaone@outlook.com?subject=Feedback'">
        <div class="icon"><span class="material-rounded icon-lg">feedback</span></div>
        <div class="content"><h3>Send feedback</h3><p>Share your thoughts with us</p></div>
      </div>
    </div>

    <div id="notice" class="notice"></div>
  </div>

  <!-- Firebase compat scripts (client-side only) -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>

<script>
  // For Firebase JS SDK v7.20.0 and later, measurementId is optional
  const firebaseConfig = {
    apiKey: "AIzaSyDaRo6aKcg5Tju7spWUtLKOUBEItUpgF90",
    authDomain: "ouruiofficial.firebaseapp.com",
    projectId: "ouruiofficial",
    storageBucket: "ouruiofficial.firebasestorage.app",
    messagingSenderId: "513335403025",
    appId: "1:513335403025:web:b965e1187d5386d52d87b0",
    measurementId: "G-X5QWNP8DMK"
  };

  // initialize firebase safely (avoid double-init)
  try {
    if (!window.firebase || !firebase.apps || !firebase.apps.length) {
      firebase.initializeApp(firebaseConfig);
    }
  } catch(e) {
    console.warn('Firebase init error:', e);
  }
  const auth = firebase.auth();

  // Wait for auth state with timeout to avoid redirecting too early
  function waitForAuthState(timeoutMs = 3000) {
    return new Promise((resolve) => {
      let done = false;
      try {
        const unsubscribe = auth.onAuthStateChanged(user => {
          if (!done) {
            done = true;
            try { unsubscribe(); } catch(e){}
            resolve(user);
          }
        });
        // fallback: resolve null after timeout
        setTimeout(() => {
          if (!done) {
            done = true;
            try { unsubscribe(); } catch(e){}
            resolve(null);
          }
        }, timeoutMs);
      } catch(e) {
        resolve(null);
      }
    });
  }

  // session flag used to avoid redirect loops
  const REDIRECT_FLAG = 'cynvia_auth_redirected';

  (async function checkAuthAndMaybeRedirect(){
    // don't redirect if already on signin page
    if (/\/?signin\.html$/i.test(location.pathname)) return;

    const user = await waitForAuthState(3000);
    if (!user) {
      // if already redirected in this session, do not redirect again
      if (!sessionStorage.getItem(REDIRECT_FLAG)) {
        sessionStorage.setItem(REDIRECT_FLAG, '1');

        // redirect only if config seems valid (basic check)
        const apiKeyLooksReal = firebaseConfig && firebaseConfig.apiKey && !firebaseConfig.apiKey.includes('YOUR_API_KEY') && firebaseConfig.apiKey.length > 10;
        if (apiKeyLooksReal) {
          // go to signin (client-side only)
          window.location.href = 'signin.html';
        } else {
          const n = document.getElementById('notice');
          n.style.display = 'block';
          n.textContent = "Firebase config missing/invalid — paste your firebaseConfig into this file so auth redirect works.";
          console.warn('Firebase config invalid; skipping redirect.');
        }
      } else {
        const n = document.getElementById('notice');
        n.style.display = 'block';
        n.textContent = "Auth check: no user found. If you're signed in on another page, ensure this file uses the same firebaseConfig.";
      }
    } else {
      // logged in — clear any redirect flag
      sessionStorage.removeItem(REDIRECT_FLAG);
      console.log('Auth OK:', user.uid || user.email || user);
      // you can show user info here if needed
    }
  })();

  // UX helpers
  function goBack(){ if (window.history.length>1) window.history.back(); else window.location.href='index.html'; }

  // Device info functions
  function detectAndroidVersion() {
    try {
      if (navigator.userAgentData && navigator.userAgentData.brands) {
        // client hints often don't expose Android version — fall back to UA
      }
    } catch(e){}
    const ua = navigator.userAgent || navigator.vendor || window.opera || '';
    const m = ua.match(/Android\s+([\d\.]+)/i) || ua.match(/Android\/([\d\.]+)/i);
    if (m && m[1]) return m[1];
    const m2 = ua.match(/Android\s*([0-9]+)/i);
    if (m2 && m2[1]) return m2[1];
    return 'Unknown';
  }
  function setAndroidVersionText() {
    const el = document.getElementById('androidVersionText');
    const ver = detectAndroidVersion();
    el.textContent = ver ? ver : 'Unknown';
  }
  function setScreenResolutionText() {
    const w = Math.max(window.innerWidth || 0, document.documentElement.clientWidth || 0);
    const h = Math.max(window.innerHeight || 0, document.documentElement.clientHeight || 0);
    const dpr = window.devicePixelRatio || 1;
    document.getElementById('screenResText').textContent = `${w} × ${h} (dpr ${dpr})`;
  }
  function setStatusText() {
    const online = navigator.onLine;
    document.getElementById('statusText').textContent = online ? 'Online' : 'Offline';
    // keep dot black (per your request). Change this line if you want colored indicator.
    document.getElementById('statusDot').style.background = '#000';
  }

  // events & initial populate
  window.addEventListener('resize', setScreenResolutionText);
  window.addEventListener('orientationchange', setScreenResolutionText);
  window.addEventListener('online', setStatusText);
  window.addEventListener('offline', setStatusText);

  setAndroidVersionText();
  setScreenResolutionText();
  setStatusText();
  setInterval(function(){ setAndroidVersionText(); setScreenResolutionText(); setStatusText(); }, 1500);
</script>
</body>
        </html>
