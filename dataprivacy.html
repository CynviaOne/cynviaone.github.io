<!doctype html>

<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Data & privacy â€" CynviaOne</title><!-- fonts / material icons (matching securitysignin.html) --><link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@20..48,600,1,0" rel="stylesheet">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200&icon_names=help" /><style>
:root{
  --bg:#FBFBFC;
  --card:#EDEBEE;
  --muted:#9a9a9a;
  --title:#0b0b0b;
  --accent:#000000; /* black pill button */
  --pill-radius:999px;
  --card-radius:22px;
  --max-w:420px;
}
*{box-sizing:border-box}
body{margin:0;background:var(--bg);font-family:Roboto,system-ui,Arial;color:var(--title);-webkit-font-smoothing:antialiased}
.container{max-width:var(--max-w);margin:6px auto;padding:18px}
.topbar{display:flex;align-items:center;justify-content:space-between;margin-bottom:8px;width:100%}
.back{background:transparent;border:0;cursor:pointer;padding:6px;border-radius:10px}
.left-section{display:flex;align-items:center;gap:10px}
.logo{font-weight:700;font-size:20px}
.logo .one{color:#2b5fbf}
.help-btn{background:transparent;border:0;cursor:pointer;padding:6px;border-radius:10px;color:#000}
.help-btn .material-symbols-outlined{font-size:24px;font-weight:900;font-variation-settings:'FILL' 1,'wght' 700,'GRAD' 0,'opsz' 24}
.title{font-size:34px;font-weight:800;margin:8px 0 6px}
.subtitle{font-size:15px;color:var(--muted);line-height:1.45;margin-bottom:18px}

/* card styles similar to securitysignin */
.section{background:transparent;margin-bottom:18px}
.card{background:var(--card);border-radius:var(--card-radius);padding:18px 18px;display:flex;gap:14px;align-items:center;box-shadow:none;position:relative;overflow:hidden}
.card .texts{flex:1}
.card h3{margin:0;font-size:20px;font-weight:800}
.card p{margin:6px 0 0;color:var(--muted);font-weight:600}
.action-row{margin-top:12px;display:flex;justify-content:flex-start;gap:10px;overflow-x:auto;padding-bottom:4px}
.action-row::-webkit-scrollbar{height:4px}
.action-row::-webkit-scrollbar-track{background:#f1f1f1;border-radius:2px}
.action-row::-webkit-scrollbar-thumb{background:#ccc;border-radius:2px}
.action-row::-webkit-scrollbar-thumb:hover{background:#bbb}
.pill{background:var(--accent);color:#fff;border-radius:var(--pill-radius);padding:10px 18px;border:0;font-weight:800;cursor:pointer;box-shadow:none;min-width:140px;text-align:center;display:inline-block;flex-shrink:0;white-space:nowrap}
.sec-heading{font-weight:800;margin:6px 0 12px;font-size:20px}
.small{font-size:13px;color:var(--muted);margin-top:8px;font-weight:600}

/* profile-list block (Looking for something else?) copied from securitysignin */
.material-rounded{font-family: 'Material Symbols Rounded';font-variation-settings: "FILL" 1, "wght" 600, "GRAD" 0, "opsz" 40;display:inline-block;line-height:1;vertical-align:middle}
.icon-lg{font-size:32px}
.profile-section{background:var(--card);border-radius:18px;padding:14px;margin-bottom:18px}
.profile-item{display:flex;align-items:center;gap:14px;padding:12px 0;cursor:pointer;transition:all 0.2s ease}
.profile-item:hover{opacity:0.8;transform:translateX(2px)}
.profile-item + .profile-item{border-top:1px solid rgba(0,0,0,0.06)}
.profile-item .icon{width:44px;height:44px;display:flex;align-items:center;justify-content:center;flex-shrink:0}
.profile-item .content{flex:1}
.profile-item h3{margin:0 0 3px;font-size:16px;font-weight:600;color:var(--title)}
.profile-item p{margin:0;font-size:13px;font-weight:400;color:var(--muted);line-height:1.3}
.more{font-size:18px;font-weight:600;margin-top:24px;margin-bottom:20px;padding-left:2px}
.full-divider {height: 4px;background: var(--bg);margin: 14px -18px;}

/* modal (reuse) */
.modal-backdrop{position:fixed;inset:0;background:rgba(0,0,0,0.45);display:none;align-items:center;justify-content:center;z-index:9999}
.modal{background:#fff;border-radius:14px;padding:18px;max-width:720px;width:92%;box-shadow:0 12px 40px rgba(0,0,0,0.15)}
.input{width:100%;padding:12px;border-radius:10px;border:1px solid #e6e6e6;margin-top:10px;font-size:15px}
.actions{display:flex;gap:10px;margin-top:14px;justify-content:flex-end}
.btn {padding:10px 14px;border-radius:10px;border:0;cursor:pointer;font-weight:700}
.btn.ghost{background:transparent;border:1px solid rgba(0,0,0,0.08)}
.btn.primary{background:var(--accent);color:#fff}

/* Loading animation */
.loading-container {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 80px 20px;
  margin: 30px 0;
}

.spinner {
  width: 40px;
  height: 40px;
  border: 4px solid transparent;
  border-top: 4px solid var(--accent);
  border-radius: 50%;
  animation: spin 1s linear infinite;
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

/* Skeleton loading for content */
.skeleton {
  background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
  background-size: 200% 100%;
  animation: loading 1.5s infinite;
}

@keyframes loading {
  0% { background-position: 200% 0; }
  100% { background-position: -200% 0; }
}

@media (max-width:820px){.title{font-size:30px}}
</style></head>
<body>
  <div class="container" role="main">
    <div class="topbar">
      <div class="left-section">
        <button class="back" onclick="goBack()" aria-label="Back"><span class="material-symbols-rounded">arrow_back</span></button>
        <div class="logo">Cynvia <span class="one">One</span></div>
      </div>
      <button class="help-btn" onclick="openMailSupport()" aria-label="Help"><span class="material-symbols-outlined">help</span></button>
    </div><div>
  <div class="title">Data & privacy</div>
  <div class="subtitle">Manage your data and privacy settings. Learn what we collect, how we use it, and control whatâ€™s stored in your CynviaOne account. You can download a copy of your account data or request permanent deletion.</div>
</div>

<!-- Loading animation in center (same as security-signin.html) -->
<div id="loadingContainer" class="loading-container">
  <div class="spinner"></div>
</div>

<!-- Main content (hidden initially) -->
<div id="mainContent" style="display: none;">
  <!-- Main sections -->
  <section class="section">
    <div class="card">
      <div style="width:52px;min-width:52px;height:52px;border-radius:12px;display:flex;align-items:center;justify-content:center"><span class="material-symbols-rounded">storage</span></div>
      <div class="texts">
        <h3>Information we collect</h3>
        <p>We collect only the information necessary to run your account â€" email, phone number, login activity, and device details.</p>
        <div class="action-row">
          <button class="pill" id="viewPolicyBtn">View full privacy policy</button>
        </div>
      </div>
    </div>
  </section>

  <div class="sec-heading">How we use data</div>
  <div class="card">
    <div style="width:52px;min-width:52px;height:52px;border-radius:12px;display:flex;align-items:center;justify-content:center"><span class="material-symbols-rounded">gavel</span></div>
    <div class="texts">
      <h3>Purpose and security</h3>
      <p>Your data is used to provide secure sign-in, account recovery, notifications you opt into, and to protect against unauthorized access.</p>
    </div>
  </div>

  <div class="sec-heading">Your controls</div>
  <div class="card" style="flex-direction:column;align-items:flex-start;gap:12px;">
    <div style="display:flex;gap:14px;align-items:center;width:100%">
      <div style="width:52px;min-width:52px;height:52px;border-radius:12px;display:flex;align-items:center;justify-content:center"><span class="material-symbols-rounded">settings</span></div>
      <div class="texts">
        <h3>Manage account settings</h3>
        <p>Update your personal info, security settings, and review devices linked to your account.</p>
      </div>
    </div>

    <div class="action-row">
      <button class="pill" onclick="location.href='https://cynviaone.github.io/u/account/personal-info'">Personal Info</button>
      <button class="pill" onclick="location.href='https://cynviaone.github.io/u/account/security-signin'">Security & Sign-in</button>
      <button class="pill" onclick="location.href='https://cynviaone.github.io/u/account/yourdevice'">Your Devices</button>
    </div>
  </div>

  <div class="sec-heading">Download & remove data</div>
  <div class="card" style="flex-direction:column;align-items:flex-start;gap:12px;">
    <div style="display:flex;gap:14px;align-items:center;width:100%">
      <div style="width:52px;min-width:52px;height:52px;border-radius:12px;display:flex;align-items:center;justify-content:center"><span class="material-symbols-rounded">download</span></div>
      <div class="texts">
        <h3>Download your data</h3>
        <p>Get a machine-readable copy (JSON) of your basic account information.</p>
      </div>
    </div>

    <div class="action-row">
      <button class="pill" id="downloadDataBtn">Download a copy</button>
      <button class="pill" id="anonymizeBtn" style="background:#666;">Anonymize my profile</button>
      <button class="pill" onclick="location.href='https://cynviaone.github.io/u/account'" style="background:#b00020;">Manage account</button>
    </div>
  </div>

  <div class="sec-heading">Privacy Policy</div>
  <div class="card">
    <div style="width:52px;min-width:52px;height:52px;border-radius:12px;display:flex;align-items:center;justify-content:center"><span class="material-symbols-rounded">article</span></div>
    <div class="texts">
      <h3>Full Privacy Policy</h3>
      <p>Read the full policy for details about data retention, sharing, and your rights.</p>
      <div class="action-row">
        <a class="pill" id="policyLink" href="https://cynviaone.github.io/privacy-policy" target="_blank">Open privacy policy</a>
      </div>
    </div>
  </div>

  <!-- Looking for something else? block (same as securitysignin.html) -->
  <div class="more">Looking for something else?</div>

  <div class="profile-section" aria-hidden="false">
    <div class="profile-item" id="aboutItem" tabindex="0" role="button" onclick="alert('About CynviaOne - Coming soon!')">
      <div class="icon"><span class="material-rounded icon-lg">info</span></div>
      <div class="content"><h3>About CynviaOne</h3><p>Learn more about CynviaOne</p></div>
    </div>

    <div class="full-divider"></div>

    <div class="profile-item" id="feedbackItem" tabindex="0" role="button" onclick="window.location.href='mailto:support.cynviaone@outlook.com?subject=Feedback'">
      <div class="icon"><span class="material-rounded icon-lg">feedback</span></div>
      <div class="content"><h3>Send feedback</h3><p>Share your thoughts with us</p></div>
    </div>
  </div>

  <div class="notice" id="mainNotice" role="status" aria-live="polite"></div>
  <div style="height:28px"></div>
</div>

  </div>  <!-- modal backdrop -->  <div id="modalBackdrop" class="modal-backdrop" role="dialog" aria-modal="true">
    <div class="modal" id="modal"></div>
  </div>  <!-- Firebase compat libs (same as securitysignin.html so download/anonymize can use auth) -->  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>  <script>
  // Firebase config
  const firebaseConfig = {
    apiKey: "AIzaSyDaRo6aKcg5Tju7spWUtLKOUBEItUpgF90",
    authDomain: "ouruiofficial.firebaseapp.com",
    projectId: "ouruiofficial",
    storageBucket: "ouruiofficial.firebasestorage.app",
    messagingSenderId: "513335403025",
    appId: "1:513335403025:web:b965e1187d5386d52d87b0",
    measurementId: "G-X5QWNP8DMK"
  };

  try {
    if (!window.firebase || !firebase.apps || !firebase.apps.length) {
      firebase.initializeApp(firebaseConfig);
    }
  } catch (e) { console.warn('Firebase init:', e); }
  const auth = firebase.auth();

  // helpers
  function goBack(){ if (history.length>1) history.back(); else location.href='index.html'; }
  function showNotice(msg, timeout=5000){ const el = document.getElementById('mainNotice'); if(!msg){ el.style.display='none'; el.textContent=''; return;} el.textContent = msg; el.style.display = 'block'; if(timeout>0) setTimeout(()=>{ el.style.display='none'; }, timeout); }

  // modal functions (same as securitysignin.html)
  const modalBackdrop = document.getElementById('modalBackdrop');
  const modalEl = document.getElementById('modal');
  function openModal(html){ modalEl.innerHTML = html; modalBackdrop.style.display = 'flex'; const input = modalEl.querySelector('input'); if(input) setTimeout(()=>input.focus(),50); }
  function closeModal(){ modalBackdrop.style.display = 'none'; modalEl.innerHTML = ''; }
  modalBackdrop.addEventListener('click', function(e){ if(e.target === modalBackdrop) closeModal(); });

  // open mail support (help icon)
  function openMailSupport(){ window.open('mailto:support.cynviaone@outlook.com?subject=Help%20with%20Data%20&%20Privacy&body=Hello%20CynviaOne%20Team,%0A%0AI%20need%20help%20with%20my%20data%20and%20privacy%20settings.%0A', '_blank'); }

  // Auth state management with redirect (fast check, same as security-signin.html)
  auth.onAuthStateChanged(user => {
    const loadingContainer = document.getElementById('loadingContainer');
    const mainContent = document.getElementById('mainContent');
    
    if (user) {
      // User is signed in - show main content
      loadingContainer.style.display = 'none';
      mainContent.style.display = 'block';
      showNotice('Signed in as ' + (user.email || user.uid), 2500);
    } else {
      // User is not signed in - redirect to signin page immediately
      showNotice('Not signed in â€" redirecting to signin page...', 3000);
      setTimeout(() => window.location.href = 'signin.html', 900);
    }
  });

  // Wait for DOM to be ready before setting up event listeners
  document.addEventListener('DOMContentLoaded', function() {
    // open privacy policy button
    const viewPolicyBtn = document.getElementById('viewPolicyBtn');
    if (viewPolicyBtn) {
      viewPolicyBtn.addEventListener('click', function(){ 
        window.open('https://cynviaone.github.io/privacy-policy', '_blank') 
      });
    }

    // DOWNLOAD DATA
    const downloadDataBtn = document.getElementById('downloadDataBtn');
    if (downloadDataBtn) {
      downloadDataBtn.addEventListener('click', async function(){
        const user = auth.currentUser;
        if(!user){ 
          showNotice('Not signed in â€" redirecting to signin page...', 3000); 
          setTimeout(() => window.location.href = 'signin.html', 900);
          return; 
        }

        const data = {
          uid: user.uid || null,
          email: user.email || null,
          phoneNumber: user.phoneNumber || null,
          displayName: user.displayName || null,
          photoURL: user.photoURL || null,
          providerData: (user.providerData || []).map(p=>({providerId:p.providerId,uid:p.uid,displayName:p.displayName,email:p.email,phoneNumber:p.phoneNumber})),
          metadata: {
            creationTime: user.metadata && user.metadata.creationTime || null,
            lastSignInTime: user.metadata && user.metadata.lastSignInTime || null
          }
        };

        const blob = new Blob([JSON.stringify(data, null, 2)], {type:'application/json'});
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url; a.download = 'cynviaone-account-' + (user.uid || 'user') + '.json';
        document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);
        showNotice('Download started');
      });
    }

    // ANONYMIZE (simple: update displayName and remove photoURL) - best effort
    const anonymizeBtn = document.getElementById('anonymizeBtn');
    if (anonymizeBtn) {
      anonymizeBtn.addEventListener('click', async function(){
        const user = auth.currentUser;
        if(!user){ 
          showNotice('Not signed in â€" redirecting to signin page...', 3000); 
          setTimeout(() => window.location.href = 'signin.html', 900);
          return; 
        }

        openModal(`
          <h2>Anonymize profile</h2>
          <p>This will replace your display name and remove your profile photo to make your profile anonymous. This action is reversible by updating your profile again.</p>
          <div class="actions">
            <button class="btn ghost" onclick="closeModal()">Cancel</button>
            <button class="btn primary" id="confirmAnonymize">Anonymize</button>
          </div>
        `);

        const confirmBtn = modalEl.querySelector('#confirmAnonymize');
        if (confirmBtn) {
          confirmBtn.onclick = async function(){
            try{
              await user.updateProfile({ displayName: 'Anonymous', photoURL: null });
              await auth.currentUser.reload();
              closeModal();
              showNotice('Profile anonymized');
            }catch(err){ 
              console.error('anonymize', err); 
              alert('Failed to anonymize profile: ' + (err.message || err)); 
            }
          };
        }
      });
    }
  });

  // closeModal globally
  window.closeModal = closeModal;
  </script></body>
</html>
